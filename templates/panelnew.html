{% extends "base_system.html" %}
{% load extras %}
{% block heading %}
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,400;0,700;1,400&display=swap" rel="stylesheet">
    {% load static %}
<script type="text/javascript" src="{% static 'js/bootstrap-filestyle.min.js' %}?v=1.0.1"></script>
<link rel="stylesheet" href="{% static 'dropify/css/dropify.min.css' %}">
<script type="text/javascript" src="{% static 'dropify/js/dropify.min.js' %}?v=1.0.0"></script>
    <style>

        .lista_actividades {
            text-align: left;
            width: 100%;
            font-size: 13px;
        }

        @media (min-width: 768px) and (max-width: 979px) {
            .lista_actividades {
                text-align: left;
                width: 100%;
            }
        }

        .carousel-item {
            padding: 15px;
        }
    </style>
    <style type="text/css">

        .row {
            --bs-gutter-x: 0.5rem;
        !important;
        }

        .radio label,
        .checkbox label {
            display: inline-block;
            cursor: pointer;
            color: #0074D9;
            position: relative;
            padding: 5px 15px 5px 51px;
            font-size: 1em;
            border-radius: 5px;
            -webkit-transition: all 0.3s ease;
            -o-transition: all 0.3s ease;
            transition: all 0.3s ease;
        }

        .radio label:hover,
        .checkbox label:hover {
            background: rgba(255, 65, 54, 0.1);
        }

        .radio label:before,
        .checkbox label:before {
            content: "";
            display: inline-block;
            width: 17px;
            height: 17px;
            position: absolute;
            left: 15px;
            border-radius: 50%;
            background: none;
            border: 3px solid #0074D9;
        }

        input[type="radio"] {
            display: none;
        }

        input[type="radio"]:checked + label:before {
            display: none;
        }

        input[type="radio"]:checked + label {
            padding: 5px 15px;
            background: #0074D9;
            border-radius: 2px;
            color: #fff;
        }

        .checkbox label:before {
            border-radius: 3px;
        }

        .checkbox input[type="checkbox"] {
            display: none;
        }

        .checkbox input[type="checkbox"]:checked + label:before {
            display: none;
        }

        .checkbox input[type="checkbox"]:checked + label {
            background: #0074D9;
            color: #fff;
            padding: 5px 15px;
        }

        {#boton de ayuda #}

        #myBtn {
            display: block;
            position: fixed;
            bottom: -2px;
            right: 0px;
            z-index: 99;
            border: none;
            outline: none;
            color: white;
            cursor: pointer;
            padding-top: 3px;
            padding-left: 13px;
            font-size: 31px;
            width: 56px;
            height: 54px;
            border-radius: 100%;
            background: #1C3247;
            margin-right: 46px;
            margin-bottom: 16px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.16), 0 3px 6px rgba(0, 0, 0, 0.23);
            transition: .3s;
        }

        #myBtn:hover {
            background-color: #555; /* Add a dark-grey background on hover */
        }

        #choiceWindow {
            display: none;
            position: fixed;
            bottom: 52px;
        {#top:180px;#} right: 40px;
            width: 20%;
            height: 45%;
        {#padding: 20px;#} border: 3px solid #e3e3e3;
            background-color: white;
            z-index: 2;
            overflow: auto;
            border-radius: 10px;
        }

        @media screen and (min-width: 1024px) {
            #choiceWindow {
                height: 50%;
                width: 32%;
            }
        }

        @media screen and (min-width: 1440px) {
            #choiceWindow {
                height: 45%;
                width: 25%;
            }
        }

        @media screen and (min-width: 1280px) {
            #choiceWindow {
                height: 45%;
                width: 20%;
            }
        }

        @media screen and (min-width: 2560px) {
            #choiceWindow {
                height: 25%;
                width: 15%;
            }
        }
    </style>
    <script type="text/javascript">
        {% if perfilprincipal.es_estudiante %}
            $(function () {
                $("#myBtn").click(function () {
                    $("#choiceWindow").slideDown(300);
                    $("#backGround").show();
                    $("#myBtn").slideUp(300);
                    $('#myBtn').tooltip('hide')

                });

                $("#cerrarsoprte").click(function () {
                    $("#choiceWindow").slideUp(300);
                    $("#backGround").hide();
                    $("#myBtn").slideDown(300);
                    $('#myBtn').tooltip();
                })

            });
        {% endif %}
        $(function () {
            $("#bookpanel").find(".btn-cerrar").click(function () {
                $("#bookpanel").modal("hide");
            });
            {#$(".action-menu-entry").hover(function () {#}
            {#    $(this).addClass("hovered");#}
            {# }, function () {#}
            {#    $(this).removeClass("hovered");#}
            {# });#}
            $(".action-menu-entry").click(function (e) {
                var url = $(this).attr('url');
                var childElementClicked = false;
                var elem = $(this);
                if ($(e.target).is(".action-menu-favorite *") || $(e.target).is(".action-menu-notification *") || $(e.target).is(".action-menu-manual-user *")) {
                    childElementClicked = true
                }
                if (childElementClicked != true) {
                    bloqueointerface();
                    if (url[0] == '/') {
                        location.href = url;
                    } else {
                        location.href = "/" + url;
                    }
                }

            });
            {#$(".action-menu-manual-user").fancybox({#}
            {#    openEffect: 'elastic',#}
            {#    closeEffect: 'elastic',#}
            {#    //modal: true,#}
            {#    showCloseButton: true,#}
            {#    hideOnOverlayClick: false,#}
            {#    hideOnContentClick: false,#}
            {#    autoSize: true,#}
            {#    type: 'iframe',#}
            {#    iframe: {#}
            {#        preload: false // fixes issue with iframe and IE#}
            {#    }#}
            {# });#}
            $(".action-menu-favorite").click(function () {
                let idm = $(this).attr("idm");
                let text = $(this).attr("text");
                let value = parseInt($(this).attr("value"));
                var question = `¿Está segur{% if persona.sexo_id == 1 %}a{% else %}o{% endif %} de ${value === 1 ? 'quitar' : 'agregar'} el módulo <b>${text}</b> como favorito?`;

                Confirm.question(question, function () {
                    bloqueointerface();
                    //closeNav();
                    var aData = {"action": "saveFavoriteMenu", 'idm': idm, 'value': value}
                    $.ajax({
                        type: "POST",
                        url: "/",
                        data: aData,
                        success: function (data) {
                            $.unblockUI();
                            if (data.result == 'ok') {
                                Swal.fire({
                                    title: `NOTIFICACIÓN`,
                                    text: data.mensaje,
                                    type: 'success',
                                    icon: 'success',
                                    showCancelButton: false,
                                    allowOutsideClick: false,
                                    confirmButtonColor: '#3085d6',
                                    cancelButtonColor: '#d33',
                                    confirmButtonText: 'Aceptar',
                                    cancelButtonText: 'Cancelar'
                                }).then((result) => {
                                    if (result.value) {
                                        bloqueointerface();
                                        location.reload();
                                    }
                                }).catch(error => {
                                    bloqueointerface();
                                    location.reload();
                                });
                            } else {
                                NotificationJG.error(data.mensaje);
                            }
                        },
                        error: function () {
                            $.unblockUI();
                            NotificationJG.error("Error al enviar los datos.");
                        },
                        dataType: "json",
                    });
                }, function () {
                });
            })
            $(".action_view_menu_notificacion").click(function () {
                var nhref = $(this).attr('nhref');
                var idprofile = $(this).attr('idprofile');
                var idmodule = $(this).attr('idmodule');
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/notificacion",
                    data: {'action': 'ViewedNotificationModule', 'idp': idprofile, 'idm': idmodule},
                    success: function (data) {
                        if (data.result == 'ok') {
                            window.location.href = nhref;
                        } else {
                            $.unblockUI();
                            NotificationJG.error(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        NotificationJG.error("Error de conexión.");
                    },
                    dataType: "json"
                });
            });
            $(".icon_archivo").hover(function () {
                $(this).addClass("hovered");
            }, function () {
                $(this).removeClass("hovered");
            });
            {% if persona.mi_cumpleannos %}
                {#$(".personaCumpleanio").snow({SnowImage: "/static/images/streamers_party_popper.gif", HideSnowTime: 34});#}
                setTimeout(function () {
                    $(".personaCumpleanio").fadeOut("slow");
                }, 31000);
            {% else %}
                var fNow = new Date();
                if (fNow.getMonth() == 11) {
                    $(document).snow({SnowImage: "/static/images/snow.gif"});
                }
            {% endif %}
            miencuesta = function (id) {
                $.get("/", {'action': 'responder', 'id': id}, function (data) {
                    ancho = $(window).height();
                    if (ancho > 50) {
                        ancho = ancho - 35
                    }
                    ;
                    $("#encuestapanel").html(data);
                    $("#encuestapanel").find(".selector").addClass("input-large");
                    $("#encuestapanel").find(".observaciones").addClass("input-block-level");
                    $("#encuestapanel").modal({backdrop: 'static', keyboard: false, width: "1024px", maxHeight: (ancho * 5) / 7});
                    $("#encuestapanel").modal("show");
                    $("#encuestapanel").find("button").click(function () {
                        encuestaok = true;
                        $(".selector").each(function (k, v) {
                            encuestaok = encuestaok && ($(v).val()) ? true : false;
                        });
                        if (encuestaok) {
                            $("#encuestapanel").modal("hide");
                            bloqueointerface();
                            $("#encuestapanel").find("form").get(0).submit();
                        } else {
                            $("#encuestapanel").find(".encuestaincompleta").show();
                        }
                    });
                    $('#cerrarencuesta').click(function () {
                        $("#encuestapanel").modal('hide');
                    });
                }, "html");
            };
            mistareas = function () {
                $.get("/", {'action': 'tareas_pendientes'}, function (data) {
                    $("#tareas_pendientes").html(data);
                    $("#tareas_pendientes").modal({backdrop: 'modal', keyboard: true, width: "1024px", maxHeight: ($(window).height() * 5) / 7});
                    $("#tareas_pendientes").modal("show");
                    $('#cerrartarea').click(function () {
                        $("#tareas_pendientes").modal('hide');
                    });
                }, "html");
            };
            {% if VER_TAREAS_MODULOS_PENDIENTES %}
                {% if tareas_pendientes %}
                    mistareas();
                {% endif %}
            {% endif %}
            // 07-06-2019
            encuestamovilidad = function (id) {
                $.get("/", {'action': 'encuestamovilidad', 'id': id}, function (data) {
                    ancho = $(window).height();
                    if (ancho > 50) {
                        ancho = ancho - 35
                    }
                    ;
                    $("#encuestapanel").html(data);
                    $("#encuestapanel").find(".selector").addClass("input-large");
                    $("#encuestapanel").find(".observaciones").addClass("input-block-level");
                    ocultarcamposotros();
                    $("#encuestapanel").modal({backdrop: 'static', keyboard: false, width: "1024px", maxHeight: (ancho * 5) / 7});
                    $("#encuestapanel").modal("show");
                    $("#encuestapanel").find("button").click(function () {
                        encuestaok = formulariocompleto();
                        /*$(".selector").each(function(k,v) {
                            //alert(v.id);
                            encuestaok = encuestaok && ($(v).val())?true:false; }
                        );*/

                        if (encuestaok) {
                            $("#encuestapanel").modal("hide");
                            bloqueointerface();
                            $("#encuestapanel").find("form").get(0).submit();
                        } else {
                            $("#encuestapanel").find(".encuestaincompleta").show();
                        }
                    });
                    $('#cerrarencuesta').click(function () {
                        $("#encuestapanel").modal('hide');
                    });
                }, "html");
            };
            // 20-04-2020
            encuestagrupo = function (id) {
                $.get("/", {'action': 'encuestagrupo', 'id': id}, function (data) {
                    ancho = $(window).height();
                    if (ancho > 50) {
                        ancho = ancho - 35
                    }
                    ;
                    $("#encuestapanel").html(data);
                    $("#encuestapanel").find(".selector").addClass("input-large");
                    {#$("#encuestapanel").find(".observaciones").addClass("input-block-level");#}
                    {#$("#encuestapanel").modal({backdrop: 'static', keyboard: false, width: "1024px", maxHeight: (ancho * 5) / 7});#}
                    $("#encuestapanel").modal("show");
                    $("#encuestapanel").find("button").click(function () {
                        encuestaok = true;
                        var botonClicado = $(this);
                        var idBotonClicado = botonClicado.attr("id");
                        $(".selector.obligatorio").each(function (k, v) {
                            encuestaok = encuestaok && ($(v).val()) ? true : false;
                        });

                        {#alert(encuestaok);#}

                        topc = 0;
                        totalmarcada = 0;
                        totalmarcar = 0;
                        $(".selectorcuadriculaopciones").each(function (k, v) {
                            if ($(v).is(":radio")) {
                                if ($(v).is(":checked")) {
                                    totalmarcada++;
                                }
                                topc++;
                            }
                        });


                        $(".totalopcionesfila").each(function (k, v) {
                            totalmarcar += parseInt($(this).data('cant'));
                        });

                        if (topc > 0) {
                            if (totalmarcada != totalmarcar)
                                encuestaok = false;
                        }

                        if (idBotonClicado === 'enviar') {
                            campo_obligatorio_completo = $("#encuestapanel").find("#id_encuesta_completa").val();
                            if (encuestaok && campo_obligatorio_completo === "true") {
                                $("#encuestapanel").modal("hide");
                                bloqueointerface();
                                $("#encuestapanel").find("form").get(0).submit();
                            } else {
                                $("#encuestapanel").find(".encuestaincompleta").show();
                            }
                        }

                    });
                    /*$('#cerrarencuesta').click(function(){
                        $("#encuestapanel").modal('hide');
                    });*/
                }, "html");
            };
            formulariocompleto = function () {
                if ($("#respuesta1").val() == 0)
                    return false;
                else if ($("#respuesta1otro").val().trim() == "" && $("#respuesta1").val() == -1)
                    return false;
                else if ($("#respuesta3").val() == 0)
                    return false;
                else if ($("#respuesta3otro").val().trim() == "" && $("#respuesta3").val() == -1)
                    return false;
                else if ($("#respuesta5").val() == 0)
                    return false;
                else if ($("#respuesta5otro").val().trim() == "" && $("#respuesta5").val() == -1)
                    return false;
                else if ($("#respuesta7").val() == 0)
                    return false;
                else if ($("#respuesta7otro").val().trim() == "" && $("#respuesta7").val() == -1)
                    return false;
                else if ($("#respuesta4").val().trim() == "" || $("#respuesta4").val().trim() == "0:00" || $("#respuesta8").val().trim() == "")
                    return false;
                else
                    return true;
            }
            ocultarcamposotros = function () {
                $("#respuesta1otro, #respuesta3otro, #respuesta5otro, #respuesta7otro").css('display', 'none');
            };
            mostrarcargadocumentos = function () {
                bloqueointerface();
                $.ajax({
                    type: "GET",
                    url: "/",
                    data: {'action': 'subirdocumentocedula'},
                    success: function (data) {
                        $.unblockUI();
                        if (data.result == 'ok') {
                            $(".panelbodycargarcedula").html(data.data);
                            $(".paneltitlecargarcedula").html(data.title);
                            $("#itemspanelcargarcedula").modal({keyboard: false, backdrop: 'static'}).modal('show');
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error de conexión.");
                    },
                    dataType: "json"
                });
            };
            $("#cerrarpanelcargarcedula").click(function () {
                $('#itemspanelcargarcedula').modal('hide');
            });
            {% if realizar_encuesta_movilidad %}
                encuestamovilidad();
            {% endif %}
            // 07-06-2019
            //26-04-2020
            {% if mostrarmensajecovid %}
                $("#itemspanelmensajecovid").modal({backdrop: 'static'}).modal('show');
            {% endif %}
            //26-04-2020
            {% if cargadocumentocedula %}
                mostrarcargadocumentos();
            {% endif %}
            $("#itemspanelmensajecovid .btn-cerrar").click(function () {
                $("#itemspanelmensajecovid").modal("hide");
            });
            {% if aplica_beca %}
                $("#itemspanelmensajebeca").modal({backdrop: 'static'}).modal('show');
                $(".aplica_beca").hide();
                $(".action-cerrar", $("#itemspanelmensajebeca")).click(function () {
                    $("#itemspanelmensajebeca").modal("hide");
                    $(".aplica_beca").show();
                    //$(document).snow({ SnowImage: "/static/images/streamers_party_popper.gif", HideSnowTime: 5, Quantity:25 });
                });
            {% endif %}
            {% if realizar_encuesta_grupo %}
                encuestagrupo({{ idencuestagrupo }});
            {% else %}

            {% endif %}
            // 20-04-2020
            {% if mensaje %}
                Swal.fire({
                    icon: 'warning',
                    type: 'warning',
                    title: 'Notificación',
                    text: 'Por favor, planifique sus actividades en el módulo " Horario Actividades "',
                    showCancelButton: false,
                    allowOutsideClick: false,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Aceptar',
                    cancelButtonText: 'Cancelar'
                });
            {% endif %}
            selecpract = function () {
                $.get("/", {'action': 'selectpract'}, function (data) {
                    $(".panelbody_pract").html(data);
                    $("#materiaspracticamodal").modal({backdrop: 'static', width: '870px'}).modal('show');
                }, "html");
            };
            $('#btn-cerrar-practicar').click(function () {
                $("#materiaspracticamodal").modal('hide');
            });
            {% if SELECCIONAR_PRACTICAS_ESTUDIANTES %}
                {% if seleccionar_practicas_pendientes %}
                    selecpract();
                {% endif %}
            {% endif %}
            aceptapractica = function () {
                $.get("/", {'action': 'aceptapractica'}, function (data) {
                    $(".panelbody_avisomalla").html(data);
                    $("#avisomalla").modal({backdrop: 'static', width: '870px'}).modal('show');
                }, "html");
            };
            $('#btn-aceptopractica').click(function () {
                var horario = parseInt($("#horario_practica").val());
                if (horario == 0) {
                    smoke.alert("Ud. debe seleccionar un horario.");
                    return false;
                }
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/",
                    data: {'action': 'aceptopractica', 'horario': horario},
                    success: function (data) {
                        if (data.result == 'ok') {
                            $.unblockUI();
                            $("#avisomalla").modal('hide');
                        } else {
                            $.unblockUI();
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al enviar los datos.");
                    },
                    dataType: "json"
                });
            });
            $('#id_ingreso_sugerencia').click(function () {
                var id_sugerencia_admision = $("#id_sugerencia_admision").val();
                if (id_sugerencia_admision != '') {
                    bloqueointerface();
                    $.ajax({
                        type: "POST",
                        url: "/",
                        data: {'action': 'ingreso_sugerencia', 'id_sugerencia_admision': id_sugerencia_admision},
                        success: function (data) {
                            if (data.result == 'ok') {
                                $.unblockUI();
                                location.reload();
                            } else {
                                $.unblockUI();
                                smoke.alert(data.mensaje);
                            }
                        },
                        error: function () {
                            $.unblockUI();
                            smoke.alert("Error al enviar los datos.");
                        },
                        dataType: "json"
                    });
                }
            });
            $(".id_telefonoencu").blur(function () {
                numerico($(this), 0, 0, 0);
            });
            $("#id_cancel_sugerencia").click(function () {
                $('#modal_sugerencia_admision').modal('hide');
            });
            $('#id_ingreso_encuesta_tecnologica').click(function () {
                lista_items1 = [];
                {%  for pregu in preguntas_enctec %}
                    var respuesta{{ pregu.id }} = 0;
                    var idp = {{ pregu.id }};
                    {%  if pregu.tipo == 1 %}
                        if (document.getElementById('pregsi{{ pregu.id }}').checked == true) {
                            respuesta{{ pregu.id }} = 1;
                        }
                        if (document.getElementById('pregno{{ pregu.id }}').checked == true) {
                            respuesta{{ pregu.id }} = 2;
                        }
                        if (respuesta{{ pregu.id }} == 0) {
                            smoke.alert('Falta responder la pregunta {{  pregu.orden }}');
                            return false;
                        } else {
                            var elemento = {
                                idp: idp,
                                res: respuesta{{ pregu.id }}
                            };
                            lista_items1.push(elemento);
                        }
                    {% elif pregu.tipo == 2 %}
                        respuesta{{ pregu.id }} = $("#rango{{ pregu.id }}").val();
                        if (respuesta{{ pregu.id }} == 0) {
                            smoke.alert('Falta responder la pregunta {{  pregu.orden }}');
                            return false;
                        } else {
                            var elemento = {
                                idp: idp,
                                res: respuesta{{ pregu.id }}
                            };
                            lista_items1.push(elemento);
                        }
                    {% elif pregu.tipo == 3 %}
                        respuesta{{ pregu.id }} = $("#abierta{{ pregu.id }}").val();
                        if (respuesta{{ pregu.id }} == "") {
                            smoke.alert('Falta responder la pregunta {{  pregu.orden }}');
                            return false;
                        } else {
                            var elemento = {
                                idp: idp,
                                res: respuesta{{ pregu.id }}
                            };
                            lista_items1.push(elemento);
                        }
                    {% endif %}
                {% endfor %}
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/",
                    data: {'action': 'ingreso_encuesta_tecnologica_presencial', "lista_items1": JSON.stringify(lista_items1)},
                    success: function (data) {
                        if (data.result == 'ok') {
                            $.unblockUI();
                            $("#modal_encuesta_tecnologica").modal("hide");
                            location.reload();
                        } else {
                            $.unblockUI();
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al enviar los datos.");
                    },
                    dataType: "json"
                });
            });
            $('#btn-noaceptopractica').click(function () {
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/",
                    data: {'action': 'noaceptopractica'},
                    success: function (data) {
                        if (data.result == 'ok') {
                            $("#avisomalla").modal('hide');
                            $.unblockUI();
                        } else {
                            $.unblockUI();
                            smoke.alert(data.mensaje);
                        }
                    },
                    error: function () {
                        $.unblockUI();
                        smoke.alert("Error al enviar los datos.");
                    },
                    dataType: "json"
                });
            });
            {% if comunicado %}
                aceptapractica();
            {% endif %}
            {% if encuestaobligatoria and utiliza_modulo_encuestas %}
                miencuesta({{ encuestaobligatoria.id }});
            {% endif %}
            $('.encuestanoobligatoria').click(function () {
                miencuesta($(this).attr('ide'));
            });
            $('#cerrarencuesta').click(function () {
                $("#encuestapanel").modal('hide');
            });
            {% if utiliza_modulo_biblioteca %}
                abrirBookInfo = function () {
                    var did = $(this).attr("did");
                    $.get("/book/" + did, {}, function (data) {
                        $("#bookpanel").find(".paneltitle").html(data.nombre);
                        $("#bookpanel").find(".panelbody").html(((data.portada) ? "<img src='" + data.portada + "' alt='' style='float: right;' width='100px'/>" : "") +
                            "Codigo: <b>" + data.codigo + "</b><br/>" +
                            "Autor: <b>" + data.autor + "</b><br/>" +
                            "Tipo: <b>" + data.tipo + "</b><br/>" +
                            "Emision: <b>" + data.emision + "</b><br/>" +
                            "A&ntilde;o: <b>" + data.anno + "</b><br/>" +
                            "Paginas: <b>" + data.paginas + "</b><br/>" +
                            "Ubicaci&oacute;n: <b>" + data.ubicacion + "</b><br/>" +
                            ((data.fisico) ? "Disponibles: <b>" + data.disponibles + "</b><br/>" : "") +
                            ((data.fisico) ? "Reservados: <b>" + data.reservas + "</b><br/>" : "") +
                            "Palabras Claves: <b>" + data.palabrasclaves + "</b><br/>" +
                            ((data.resumen) ? "Resumen: <b>" + data.resumen + "</b>" : "") +
                            ((data.digital) ? "<a href='" + data.digital + "'><i class='fa fa-arrow-down'></i> Descargar</a>" : "") +
                            "");
                        if (data.disponiblesreserva) {
                            $("#reserva").show().attr({"idl": did});
                        } else {
                            $("#reserva").hide();
                        }
                        $('#bookpanel').modal("show");
                    }, "json");
                };
                $("#reserva").click(function () {
                    $('#bookpanel').modal("hide");
                    bloqueointerface();
                    var id = $(this).attr("idl");
                    $.post("/", {"action": "reservalibro", "id": id}, function (data) {
                        $.unblockUI();
                        if (data.result == "ok") {
                            smoke.alert("Se ha efectuado la reserva correctamente.");
                            location.href = location.href;
                        } else {
                            smoke.alert(data.mensaje);
                        }
                    }, "json");
                });
                $(".eliminarreserva").click(function () {
                    bloqueointerface();
                    var id = $(this).attr("idr");
                    $.post("/", {"action": "eliminarreservalibro", "id": id}, function (data) {
                        if (data.result == "ok") {
                            location.href = location.href;
                        } else {
                            $.unblockUI();
                            smoke.alert(data.mensaje);
                        }
                    }, "json");
                });
                $("#bibliosearch").click(function () {
                    var busqueda = $("#biblioinput").val().trim();
                    if (busqueda.length > 0) {
                        bloqueointerface();
                        $.post('/bibliosearch', {'search': busqueda}, function (data) {
                            $.unblockUI();
                            if (data.result == "ok") {
                                $("#contenidocentral").empty().html(data.pagina).find(".bookinfo").click(abrirBookInfo);
                            } else {
                                smoke.alert(data.mensaje);
                            }
                        }, "json");
                    }
                });
                $("#biblioinput").keypress(function (e) {
                    if (e.which == 13) {
                        $("#bibliosearch").trigger("click");
                    }
                });
                chequeaBiblioInput = function () {
                    if ($.trim($("#biblioinput").val()) == '') {
                        $("#bibliosearch").attr("disabled", true);
                    } else {
                        $("#bibliosearch").attr("disabled", false);
                    }
                };
                $("#biblioinput").keyup(chequeaBiblioInput);
                chequeaBiblioInput();
                $("#otrasbibliotecas").click(function () {
                    bloqueointerface();
                    $.post('/otrasbiblio', {}, function (data) {
                        $.unblockUI();
                        $("#contenidocentral").empty().html(data);

                    }, "html");
                });
            {% endif %}
            localStorage.removeItem('tabhojavida');
            $("#cancel_cancelar").click(function () {
                $('#modalaplicar').modal('hide');
            });
            $("#cancel_cancelarrechazar").click(function () {
                $('#modalaplicarrechazar').modal('hide');
            });
            $("#boton_aplicar").click(function () {
                var codigoins = $("#idcodigoinscripcionapl").val();
                $("#boton_aplicar").hide();
                $("#cancel_cancelar").hide();
                {#$('#bodyaplicar').html('').append("<p>Espere por favor.</p>");#}
                $.post("/", {"action": "aplicarmalla", "codigoins": codigoins}, function (data) {

                    if (data.result == "ok") {
                        bloqueointerface();
                        {#$('#bodyaplicar').html('').append("<p>Se ha efectuado la reserva correctamente.</p>");#}
                        $('#modalaplicar').modal('hide');
                        $('#itemspanelaceptacion').modal('hide');
                        {#alert(data.codigoperfilusuario)#}
                        {#location.reload();#}
                        location.href = '/cudu?id=' + data.codigoperfilusuario;
                    } else {
                        $.unblockUI();
                        smoke.alert(data.mensaje);
                    }
                }, "json");
            });
            $("#boton_aplicarrechazar").click(function () {
                var codigoins = $("#idcodigoinscripcion").val();
                var idmotivo = $("#id_motivo").val();
                if ($("#id_motivo").val().trim() == '') {
                    $("#idvalidamotivo").show(300);
                    $("#id_motivo").val('')
                    $("#idvalidamotivo").html('Favor ingrese motivo.');
                    return false;
                }
                $("#boton_aplicarrechazar").hide();
                $("#cancel_cancelarrechazar").hide();

                {#$('#bodyrechazar').html('').append("<p>Espere por favor.</p>");#}
                $.post("/", {"action": "rechazarmalla", "codigoins": codigoins, "idmotivo": idmotivo}, function (data) {
                    {#$.unblockUI();#}
                    if (data.result == "ok") {
                        $('#modalaplicarrechazar').modal('hide');
                        $('#itemspanelaceptacion').modal('hide');
                        bloqueointerface();
                        location.reload();
                        {#$('#bodyrechazar').html('').append("<p>Se ha efectuado la reserva correctamente.</p>");#}
                        {#location.href="/aceptacionmalla?id={{ perfilprincipal.id|encrypt }}";#}
                    } else {
                        smoke.alert(data.mensaje);
                    }
                }, "json");
            });
        });

        function aceptarmalla(idcohorte) {
            bloqueointerface();
            {#$('#idcohorte').val(idcohorte);#}
            $("#modalaplicar").modal({backdrop: 'static', width: '600px'}).modal('show');
            $.unblockUI();
        }

        function rechazarmalla(idcohorte) {
            bloqueointerface();
            {#$('#idcohorte').val(idcohorte);#}
            $("#modalaplicarrechazar").modal({backdrop: 'static', width: '600px'}).modal('show');
            $.unblockUI();
        }

        $(function () {
            {% if eventos %}
                $("#modalasistenciaevento").modal({backdrop: 'static', width: '600px'}).modal('show');
                {% if eventos.obligatorio %}
                    $("#close_evento").addClass('d-none')
                {% endif %}
            {% endif %}
        });

        function registrarasistencia(tipo, evento, inscripcion='') {
            var msgalerta = ''
            if (tipo === '1') {
                msgalerta = 'Está a punto de confirmar su asistencia al evento.\n ¿Desea continuar?'
            } else {
                msgalerta = 'Está a punto de declinar su asistencia al evento.\n ¿Desea continuar?'

            }
            Swal.fire({
                title: msgalerta,
                type: 'info',
                showCancelButton: true,
                allowOutsideClick: false,
                confirmButtonColor: '#ffaa46',
                cancelButtonColor: '#E7E7E7',
                confirmButtonText: 'Confirmar',
                cancelButtonText: 'Cancelar'
            }).then((result) => {
                if (result.value) {
                    bloqueointerface();
                    $.ajax({
                        data: {
                            'action': 'confirmaasistencia', 'id': evento, 'idinscripcion': inscripcion, 'tipo': tipo
                        },
                        url: '/alu_eventos',
                        type: "POST",
                        dataType: 'json',
                        success: function (data) {
                            $.unblockUI();
                            if (data.resp) {
                                if (data.link){
                                    window.open(data.link, '_blank');
                                }
                                Swal.fire({
                                    title: data.msg,
                                    type: 'success',
                                    showCancelButton: false,
                                    allowOutsideClick: false,
                                    confirmButtonColor: '#3085d6',
                                    confirmButtonText: 'Ok'
                                }).then((result) => {
                                    if (result.value) {
                                        if (data.link){
                                            location.reload()
                                        }else{
                                            setTimeout(window.location = "/alu_eventos?action=miseventos", 10);
                                        }
                                    }
                                })
                            } else {
                                Swal.fire(data.msg, 'Eventos', 'error')
                            }
                        },
                        error: function () {
                            $.unblockUI();
                            Swal.fire("Error de conexión.", 'Eventos', 'error')
                        },
                    }).fail(function () {
                        $.unblockUI();
                        Swal.fire("Error de conexión.", 'Eventos', 'error')
                    });
                }
            })
        }
    </script>
    <script>

    </script>
    {% if actualizacion_localidad and actualizacion_localidad_con_mapa %}
        {% if not localizacionactualizada_est %}
            <link rel="stylesheet" href="/static/css/leaflet/css/leaflet.css"/>
            <link rel="stylesheet" href="/static/css/leaflet/leaflet1.css?0.1"/>
            <link rel="stylesheet" href="/static/css/leaflet/leaflet-search.css"/>
            <script>
                function buscarEnMapa() {
                    let future_mapOptions = {
                        {#center: [ 0E-16 , 0E-16 ],#}
                        zoom: 1.75,
                        minZoom: 1.75,
                    }
                    var browserLat;
                    var browserLong;
                    var marker_actual;
                    var map = L.map('map', future_mapOptions).setView([-1.574876, -78.636631], 5);
                    {#map.addLayer(new L.TileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png'));#}
                    map.addLayer(new L.TileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'));	//base layer
                    navigator.geolocation.getCurrentPosition(function (position) {
                        browserLat = position.coords.latitude;
                        browserLong = position.coords.longitude;
                        marker_actual = L.marker([browserLat, browserLong]).addTo(map);
                        {#marker_actual.bindPopup(`<span style="font-size: 9px"><b>Ubicación actual</b> ${browserLat},${browserLong}</span>`).openPopup();#}
                        marker_actual.bindPopup(`<span style="font-size: 9px"><b>Ubicación actual</b> ${browserLat},${browserLong}</span>`);
                        map.setView([browserLat, browserLong], 10);
                        $('#id_latitud').val(browserLat);
                        $('#id_longitud').val(browserLong);
                    }, function (err) {
                        Swal.fire('Active la ubicación de esta página, si usted a denegado el acceso en su navegador para rastrear su ubicación\n vuelva a activarla ingresando a \n Configuración > Privacidad > Ubicación\n y permita el acceso a este sitio.', '', 'error');
                    });
                    var popup = L.popup();
                    var marker = L.marker();

                    function onMapClick(e) {
                        var lat = e.latlng.lat;
                        var lon = e.latlng.lng;
                        marker.setLatLng(e.latlng);
                        marker.addTo(map)
                        obje = {lat: lat, lng: lon}
                        $('#id_latitud').val(lat);
                        $('#id_longitud').val(lon);
                    }

                    var es_chrome = navigator.userAgent.toLowerCase().indexOf('firefox') > -1;
                    if (es_chrome) {
                        mensajeFlotante('', 'Te sugerimos cambiar de navegador (de preferencia a Google Chrome)')
                    }

                    function onLocationError(e) {
                        console.log(e)
                        if (e.message == 'User denied Geolocation') {
                            Swal.fire('Active la ubicación de esta página, si usted ha denegado el acceso en su navegador para rastrear su ubicación\n vuelva a activarla ingresando a \n Configuración > Privacidad > Ubicación\n y permita el acceso a este sitio.', '', 'error');
                        } else if (e.message == 'User denied geolocation prompt') {
                            Swal.fire('Active la ubicación de esta página, si usted ha denegado el acceso en su navegador para rastrear su ubicación\n vuelva a activarla ingresando a \n Configuración > Privacidad > Ubicación\n y permita el acceso a este sitio.', '', 'error');
                        } else if (e.message == 'Geolocation error: User denied geolocation prompt.') {
                            Swal.fire('Active la ubicación de esta página, si usted ha denegado el acceso en su navegador para rastrear su ubicación\n vuelva a activarla ingresando a \n Configuración > Privacidad > Ubicación\n y permita el acceso a este sitio.', '', 'error');
                        } else if (e.message == 'Geolocation error: Timeout expired.') {
                            Swal.fire('Tiempo de espera expirado.\n Active la ubicación de esta página, si usted ha denegado el acceso en su navegador para rastrear su ubicación\n vuelva a activarla ingresando a \n Configuración > Privacidad > Ubicación\n y permita el acceso a este sitio.', '', 'error');
                        } else {
                            Swal.fire(e.message, '', 'error');
                        }
                    }

                    $('#actualizarMapa').on('click', function () {
                        navigator.geolocation.getCurrentPosition(function (position) {
                            browserLat = position.coords.latitude;
                            browserLong = position.coords.longitude;
                            marker_actual.remove()
                            marker_actual = L.marker([browserLat, browserLong]).addTo(map);
                            marker_actual.bindPopup(`<span style="font-size: 9px"><b>Ubicación actual</b><br> ${browserLat},${browserLong}</span>`);
                            map.setView([browserLat, browserLong], 17);
                            $('#id_latitud').val(browserLat);
                            $('#id_longitud').val(browserLong);
                        }, function (e) {
                            if (e.message == 'User denied Geolocation') {
                                Swal.fire('Active la ubicación de esta página, si usted ha denegado el acceso en su navegador para rastrear su ubicación\n vuelva a activarla ingresando a \n Configuración > Privacidad > Ubicación\n y permita el acceso a este sitio.', '', 'error');
                            } else if (e.message == 'User denied geolocation prompt') {
                                Swal.fire('Active la ubicación de esta página, si usted ha denegado el acceso en su navegador para rastrear su ubicación\n vuelva a activarla ingresando a \n Configuración > Privacidad > Ubicación\n y permita el acceso a este sitio.', '', 'error');
                            } else {
                                Swal.fire(err.message, '', 'error');
                            }
                        });
                    })
                    map.on('locationerror', onLocationError);
                    map.locate({setView: true, maxZoom: 22});
                    map.on('click', function (e) {
                        lat = e.latlng.lat;
                        lon = e.latlng.lng;
                        if (marker_actual) {
                            marker_actual.remove()
                        }
                        marker_actual = L.marker([lat, lon]).addTo(map);
                        marker_actual.bindPopup(`<span style="font-size: 9px"><b>Ubicación actual</b><br> ${lat},${lon}</span>`);
                        map.setView([lat, lon]);
                        $('#id_latitud').val(lat);
                        $('#id_longitud').val(lon);
                    });
                    map.addControl(new L.Control.Search({
                        url: 'https://nominatim.openstreetmap.org/search?format=json&q={s}',
                        jsonpParam: 'json_callback',
                        propertyName: 'display_name',
                        propertyLoc: ['lat', 'lon'],
                        marker: L.circleMarker([0, 0], {radius: 10}),
                        autoCollapse: true,
                        autoType: true,
                        minLength: 2
                    }));
                    setTimeout(function () {
                        map.invalidateSize();
                    }, 400);
                }
            </script>
            <script src="/static/css/leaflet/css/leaflet.js"></script>
            <script src="/static/css/leaflet/leaflet-search.js"></script>
            <script src="/static/css/leaflet/css/L.Control.Locate.min.js" charset="utf-8"></script>
        {% endif %}
    {% endif %}

<script src="{% static 'adicionalesjs/formquestionb4.js' %}?0.24"></script>
{#  TOUR  #}
<link rel="stylesheet" href="{% static 'modaltour.css' %}?0.1">
<link rel="stylesheet" href="{% static 'cabonads.css' %}?0.3.3">
<link href="{% static 'intro.js/minified/introjs.min.css' %}?0.1" rel="stylesheet"/>
<script src="{% static 'intro.js/minified/intro.min.js' %}"></script>
    <script>

        {% if visualizar_tutorial %}
            function startIntro() {
                intro = introJs();
                intro.setOptions({
                    nextLabel: 'Siguiente',
                    prevLabel: 'Anterior',
                    skipLabel: 'Salir',
                    doneLabel: 'Listo',
                    disableInteraction: false,
                    exitOnEsc: false,
                    exitOnOverlayClick: false,
                    showBullets: true,
                    showButtons: true,
                    keyboardNavigation: true,
                    showProgress: false,
                    steps: [
                        {
                            element: document.querySelector('#panelNotificacionesUsuario'),
                            intro: "<img src='/static/logos/mano_touch.svg' style='width: 60px'/><br> Acceso al panel de notificaciones.",
                            position: 'left',
                        },
                        {
                            element: document.querySelector('#panelPerfilUsuario'),
                            intro: "<img src='/static/logos/mano_touch.svg' style='width: 60px'/><br> Edición y configuración del perfil de usuario.",
                            position: 'right',
                        },
                        {% if modulos_favoritos %}
                            {
                                element: document.querySelector('.menuPanelFavoritos'),
                                intro: "Acceso rápido de las principales opciones del sistema.",
                                position: 'right',
                            },
                        {% endif %}
                        {
                            element: document.querySelector('.menuPanelModulos'),
                            intro: "Módulos del sistema.",
                            position: 'left',
                        },

                    ]
                });
                intro.onchange(function (targetElement) {
                    var pasos = this._currentStep;
                }).start();
                intro.oncomplete(function () {
                    bloqueointerface();
                    $.ajax({
                        type: 'POST',
                        url: '{{ reques.path }}',
                        async: false,
                        data: {
                            csrfmiddlewaretoken: '{{ csrf_token }}',
                            action: 'fintour',
                        },
                        dataType: "json",
                        beforeSend: function () {
                            bloqueointerface();
                        }
                    }).done(function (data) {
                        setTimeout($.unblockUI, 1);
                        if (data.error === false) {
                        }
                    }).fail(function (jqXHR, textStatus, errorThrown) {
                        setTimeout($.unblockUI, 1);
                        NotificationJG.error('Error en el servidor', 'Advertencia!', 10000);
                    }).always(function () {
                    });
                });
            }

            function initTour() {
                localStorage.removeItem("tour_current_step");
                localStorage.removeItem("tour_end");
                startIntro();
            }

            $(function () {

                $('#iniciarTour').on('click', function () {
                    $('#modalTourInicial').modal("hide");
                    initTour()
                })

                $('#modalTourInicial').modal('show')


            })
        {% endif %}

        $(function () {
            $(".menuPanelFavoritos > li").hover(function () {
                var idfav_ = $(this).attr('data-id');
                $(`.icofav${idfav_}`).addClass('animated pulse');
            }, function () {
                var idfav_ = $(this).attr('data-id');
                $(`.icofav${idfav_}`).removeClass('animated pulse');
            });
        })
    </script>
    {#  TOUR  #}
    {# BUSCADOR #}
    <script>
        $(function () {
            $('#idbuscador').keyup(function () {
                var _this = this;
                var searchText = $(this).val();
                $('.menuPanelFavoritos > .action-menu-entry').each(function () {
                    var currentLiText = $(this).text().toUpperCase(), showCurrentLi = currentLiText.indexOf(searchText.toUpperCase()) !== -1;
                    if (converToAscii($(this).text().toLowerCase()).indexOf(converToAscii($(_this).val().toLowerCase())) === -1) {
                        $(this).hide();
                    } else {
                        $(this).show();
                    }
                });
                $('.menuPanelCard > .action-menu-entry').each(function () {
                    var currentLiText = $(this).text().toUpperCase(), showCurrentLi = currentLiText.indexOf(searchText.toUpperCase()) !== -1;
                    if (converToAscii($(this).text().toLowerCase()).indexOf(converToAscii($(_this).val().toLowerCase())) === -1) {
                        $(this).hide();
                    } else {
                        $(this).show();
                    }
                });
                if (searchText === "") {
                    // Cerrar todos los acordeones
                    $('.accordion-collapse').removeClass('show');
                    $('.accordion-button-menu').addClass('collapsed');
                } else {
                    // Abrir todos los acordeones
                    $('.accordion-collapse').addClass('show');
                    $('.accordion-button-menu').removeClass('collapsed');
                }
            });
        })
    </script>
    {# BUSCADOR #}
{% endblock %}
{% block canvas %}

    <div class="modal fade  static" id="itemspanelform" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4><i class="fa fa-map-marker"></i> <b>ACTUALIZACIÓN DE DATOS</b></h4>
                    <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form autocomplete="off" method="post" class="modaldatospanel"
                      enctype="multipart/form-data" action="{{ request.path }}">
                    {% csrf_token %}
                    <div class="modal-body">
                        <div class="row panelbodyform">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" id="submit" class="btn btn-success"><i class="fa fa-check-circle"></i> Guardar</button>
                        <a href="javascript:;" class="btn btn-danger" data-bs-dismiss="modal"><i class="fa fa-window-close"></i> Cancelar</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="modal fade  static" id="itemspanelformsedes" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header" style="background-color: #1C3247 ; !important; color: white;">
                    <h3><i class="fa fa-building"></i> <b>Confirmación Lugar de Votación</b></h3>
                </div>
                <form autocomplete="off" method="post" class="modaldatospanel" style="width: 100%; margin-left: 0px; !important;"
                      enctype="multipart/form-data" action="{{ request.path }}">
                    {% csrf_token %}
                    <div class="modal-body">
                        <div class="panelbodyformsedes">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" id="submit" class="btn btn-success"><i class="fa fa-check-circle"></i> Confirmar</button>
                        <a href="javascript:;" hidden id="cancelarSedeEleccion" class="btn btn-danger" data-bs-dismiss="modal"><i class="fa fa-window-close"></i> Cancelar</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="waitpanelmensaje" style="display: none;">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-lg-3">
{#                            <img src="/static/images/undraw/mailsuccess.png">#}
                        </div>
                        <div class="col-lg-9" style="text-align: justify;"><br>
                            <p id="textpanelmensaje"></p>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <a id="returnpanelmensaje" class="btn btn-primary text-left bloqueo_pantalla">
                        <i class="fa fa-check-circle"></i> Aceptar</a>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade static" id="modalasistenciaevento" style="display: none; ">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                 <div class="modal-header border-0 pb-2">
                    <h4 class="modal-title">
                        <i class="fa fa-bullhorn me-1" id="title-icon"></i> <span id="panel-title">Eventos Disponibles</span>
                    </h4>
                    <button type="button" class="btn-close-blue" data-bs-dismiss="modal" aria-label="Close" id="close_evento">
                    </button>
                </div>
{#                <div class="modal-header" style="background-color: #ddd; !important; color: #0c0c0c;">#}
{#                    <h4><i class="fa fa-bullhorn"></i> Evento Disponible</h4>#}
{#                </div>#}
                <div class="modal-body panelbody row pb-4">
                    <div style="padding: 0px; !important; margin-top: -2px;">
                        <div class="thumbnail p-0" style="word-break: break-word; ms-word-break: break-word; text-align: justify;">
                        </div>
                    </div>
                </div>
{#                <div class="modal-footer" id="footermodal">#}
{#                    <button type="button" class="btn btn-default" data-bs-dismiss="modal"><i class="fa fa-times"></i> Cerrar</button>#}
{#                </div>#}
            </div>
        </div>
    </div>

    <div class="row" id="panelPrincipal">
{#        <div class="contenedor-nieve">#}
{#            <img src="">#}
{#        </div>#}

        {# BUSCADOR PRINCIPAL #}
        <div class="col-lg-12 col-md-12 col-12">
            <div class="pb-2 mb-1 d-lg-flex justify-content-between align-items-center">
                <div class="mb-3 mb-lg-0">
                    {% if tipoentrada == 'SGA' %}
                        <h4 class="mb-0" style="color: #012E46;margin-left: 5px;">¡<b>Hola {{ persona.nombre_minus }}</b>, {% if persona.sexo.id == 1 %}bienvenida{% else %}bienvenido{% endif %} Clínica Santa Elene!</h4>
                    {% elif tipoentrada == 'SAGEST' %}
                        <h4 class="mb-0" style="color: #012E46;margin-left: 5px;">¡<b>Hola {{ persona.nombre_minus }}</b>, {% if persona.sexo.id == 1 %}bienvenida{% else %}bienvenido{% endif %} al sistema clínico!</h4>
                    {% elif tipoentrada == 'POSGRADO' %}
                        <h4 class="mb-0" style="color: #012E46;margin-left: 5px;">¡<b>Hola {{ persona.nombre_minus }}</b>, {% if persona.sexo.id == 1 %}bienvenida{% else %}bienvenido{% endif %} al Sistema de Admisión Posgrado!</h4>
                    {% endif %}
                </div>
                <div class="d-flex">
                    <div class="input-group me-3">
                        <input class="form-control" id="idbuscador" type="text" placeholder="&#xF002 Buscar..." style="font-family:Arial, FontAwesome">
                    </div>
                </div>
            </div>
        </div>
        {# BUSCADOR PRINCIPAL #}

        {# CONTENIDO ADICIONAL #}
        <div class="col-lg-12" id="contenidocentral">

            {% if existeperiodoactivo %}
                {% if milugarvotacion %}
                    <div class="alert alert-warning">
                        <h3 style="line-height: 20px; !important;">
                            <i class="fa fa-vote-yea"></i> ELECCIÓN DE {{ periodoelectoral.nombre }}
                        </h3>
                        <b>Fecha Elecciones:</b> {{ periodoelectoral.fecha|date:"d" }}-{% traducir_mes periodoelectoral.fecha|date:"F" %}-{{ periodoelectoral.fecha|date:"Y" }} de 08:00 a 17:00
                        <br>{{ persona.nombre_completo_inverso }}, te informamos que su lugar de votación es:
                        <ul>
                            {% for mi in milugarvotacion %}
                                <li><b style="font-size: 18px">MESA {{ mi.get_tipo }}</b>: <span style="font-size: 18px; background-color: #1C3247 " class="label label-darkgreen">{{ mi.lugar | upper }}</span>
                                    <br><a href="https://www.google.com/maps/search/{{ mi.lugarsede.latitudstr }},{{ mi.lugarsede.longitudstr }}" target="_blank" class="btn btn-primary btn-mini"><i class="fa fa-map-marker"></i> Ver Ubicación</a></li>
                                {% if mi.info_mesa %}
                                    <li>
                                        <b class="text-error" style="font-size: 14px;">
                                            Usted ha sido designado como miembro de Junta Receptora del Voto.
                                            <a href="javascript:void(0)" onclick="mensajeFlotante('<b>MIEMBRO DE LA COMUNIDAD UNIVERSITARIA CON DERECHO A VOTO</b><br> <b>ROL:</b> {{ mi.info_mesa.0 }}<br><b>LUGAR:</b> {{ mi.info_mesa.1 }}<br><b>FECHA ASIGNACIÓN:</b> {{ mi.info_mesa.6 }}')"> <i class="fa fa-eye"></i> Ver más</a>
                                        </b>
                                    </li>
                                {% endif %}
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}
            {% endif %}

            {% if mostrarventanavacunacovid and encuesta_vacuna_activa %}
                <div class="alert alert-success">
                    <h3><i class="fa fa-syringe"></i> Encuesta Vacunación Covid 19</h3>
                    <div style="font-size: 15px;">UNEMI considera que la opinión y bienestar de nuestra comunidad universitaria es importante, la información proporcionada es confidencial.
                        <br><a href="/th_hojavida?tab=datosmedicos" class="btn btn-primary text-left bloqueo_pantalla"><i
                                class="fa fa-check-circle"></i>
                            Ir al formulario</a></div>
                </div>
            {% endif %}

            {% if aperturasolicitudpractica and not tienepenalizacionpractica %}
                <div class="alert alert-primary">
                    <h3><i class="fa fa-business-time"></i> Comunicado del proceso de homologación para prácticas pre profesionales</h3>
                    {{ aperturasolicitudpractica.mensaje|safe }}
                </div>
            {% endif %}

            {% if confpreinscripcion and tiene_preinscripcion %}
                <div class="alert alert-info">
                    <h3><i class="fa fa-briefcase"></i> Comunicado del proceso de pre inscripción a prácticas pre profesionales</h3>
                    {{ confpreinscripcion.mensaje|safe }}
                </div>
            {% endif %}

            {% if matriculaposgrado.bloqueomatricula and  matriculaposgrado.inscripcion.coordinacion.id == 7 %}
                <div class="alert alert-danger">
                    <div class="form-horizontal">
                        <h4 class="alert-heading">MATRÍCULA BLOQUEADA</h4>
                        <h5>Estimado/a alumno, mantiene cuotas vencidas en el módulo "Mis Finanzas" por lo tanto
                            su matrícula se encuentra bloqueada para asistencia, tareas y registro de calificaciones.
                        </h5>
                    </div>
                </div>
            {% endif %}

            {% if aplica_beca %}
                <div class="alert alert-danger aplica_beca" style="background-image: url('/static/images/aok/bd_becas.png'); background-size: cover; border-radius: 25px; border-color: #002E45 !important; padding: 0 !important;">
                    <div class="row hidden-tablet hidden-phone visible-desktop">
                        <div class="col-lg-9" style="text-align: justify; padding-left: 40px; padding-right: 40px">
                            <br><br><br>
                            <p style="color: #ffffff;">{{ textomensajebeca|safe }}</p>
                            <br>
                        </div>
                        <div class="col-lg-3" style="text-align: center; vertical-align: middle; align-items: center;">
                            <img style="height: 250px; min-height: 250px; width: 195px; min-width: 195px;" src='/static/images/medalla_beca_2.png'/>
                        </div>
                    </div>
                    <div class="row hidden-desktop visible-phone visible-tablet">
                        <div class="col-lg-8" style="text-align: justify; padding-left: 40px; padding-right: 40px">
                            <br><br><br>
                            <p style="color: #ffffff;">{{ textomensajebeca|safe }}</p>
                            <br>
                        </div>
                        <div class="col-lg-4" style="text-align: center; vertical-align: middle; align-items: center;">
                            <img style="height: 250px; min-height: 250px; width: 195px; min-width: 195px;" src='/static/images/medalla_beca_2.png'/>
                        </div>
                    </div>
                </div>
            {% endif %}

            {#            {% if persona.mi_cumpleannos %}#}
            {#                <div class="alert alert-danger personaCumpleanio" style="background-color:#f2f2f2 !important;border: solid 1px #f2f2f2;">#}
            {#                    <a href="javascript:;" class="close" data-bs-dismiss="alert">×</a>#}
            {#                    <div class="row">#}
            {#                        <div class="col-lg-4" style="text-align: left; ">#}
            {#                            <p></p>#}
            {#                            <img style="height:210px !important" src='/static/images/iconos/cake1.png'/>#}
            {#                        </div>#}
            {#                        <div class="col-lg-6" style="text-align: center">#}
            {#                            <br><br><br><br>#}
            {#                            <p style="color: #0a677e; font-family: 'Arial Rounded MT Bold';font-style: oblique; font-size: 22px">La {{ institucion }} espera que hoy pases un feliz día en compañía de tus familiares y seres amados.</p>#}
            {#                        </div>#}
            {#                        <div class="col-lg-2" style="text-align: right;">#}
            {#                            <img style="height:210px !important" src='/static/images/iconos/cake2.png'/>#}
            {#                        </div>#}
            {#                    </div>#}
            {#                </div>#}
            {#            {% endif %}#}

            {% if es_profesor %}
                {% with tienefechas=profesornombre|args:periodo|call:"profesorfechaparessincoor" %}
                    {% if tienefechas %}
                        <div class="alert alert-info">
                            <a href="javascript:;" class="close" data-bs-dismiss="alert">×</a>
                            <h4 class="alert-heading">Cronograma para su evaluación de Pares</h4>
                            Estimado docente, se comunica que la fecha y hora de su evaluación por pares es: <b>{{ tienefechas.fecha|date:"Y-m-d" }}</b> en horario de <b>{{ tienefechas.horainicio }}</b> a <b>{{ tienefechas.horafin }}</b>{% if tienefechas.lugar %} lugar <b>{{ tienefechas.lugar }}</b>{% else %}.{% endif %}.
                        </div>
                    {% endif %}
                {% endwith %}
                {% with tienefechasdirectivo=profesornombre|args:periodo|call:"profesorfechadirectivo" %}
                    {% if tienefechasdirectivo %}
                        <div class="alert alert-info">
                            <a href="javascript:;" class="close" data-bs-dismiss="alert">×</a>
                            <h4 class="alert-heading">Cronograma para su evaluación de Directivo</h4>
                            Estimado docente, se comunica que la fecha y hora de su evaluación por directivo es: <b>{{ tienefechasdirectivo.fecha|date:"Y-m-d" }}</b> en horario de <b>{{ tienefechasdirectivo.horainicio }}</b> a <b>{{ tienefechasdirectivo.horafin }}</b>{% if tienefechasdirectivo.lugar %} lugar <b>{{ tienefechasdirectivo.lugar }}</b>{% endif %}.
                        </div>
                    {% endif %}
                {% endwith %}
            {% endif %}

            {% if tiene_valores_pendientes %}
                {{ msg_valores_pendientes|safe }}
            {% endif %}

            {% if hojavidallena %}
                <div class="alert alert-info">
                    <a href="javascript:;" class="close" data-bs-dismiss="alert">×</a>
                    <h4 class="alert-heading">AVISO</h4>
                    Aun no ha actualizado su <b>HOJA DE VIDA</b>, <a href="/th_hojavida"> actualizar</a>
                </div>
            {% endif %}

            {% if datosmedicosincompletos and utiliza_ficha_medica %}
                <div class="alert alert-danger">
                    <a href="javascript:;" class="close" data-bs-dismiss="alert">×</a>
                    <h4 class="alert-heading">ALERTA</h4>
                    Aun le quedan DATOS MEDICOS por llenar en su Ficha M&eacute;dica,
                    por favor ingreselos lo m&aacute;s pronto posible
                </div>
            {% endif %}

            {% if inscripcion and necesita_evaluar %}
                <div class="alert alert-danger">
                    <a href="javascript:;" class="close" data-bs-dismiss="alert">×</a>
                    <h4 class="alert-heading">ALERTA</h4>
                    Aun no ha realizado todas las <b>EVALUACIONES DOCENTES</b> en este per&iacute;odo,
                    por favor proceda a evaluar lo antes posible, Gracias
                </div>
            {% endif %}

            {% if ofertasdisponibles %}
                <div class="alert alert-info">
                    <a href="javascript:;" class="close" data-bs-dismiss="alert">×</a>
                    <h3 class="alert-heading">AVISO</h3>
                    Existen Ofertas Laborales para tu perfil, <b><a href="/alu_ofertalaboral">Conocer más</a></b>
                </div>
            {% endif %}

            {% if entrevistaspendientes %}
                <div class="alert alert-success">
                    <a href="javascript:;" class="close" data-bs-dismiss="alert">×</a>
                    <h3 class="alert-heading"><i class="fa fa-info-circle"></i> AVISO IMPORTANTE</h3>
                    Usted tiene entrevista(s) pendiente, <b><a href="/alu_ofertalaboral">Conocer más</a></b>
                </div>
            {% endif %}

            {#            {% if noticias %}#}
            {#                {% for noticia in noticias %}#}
            {#                    <div class="alert alert-info">#}
            {#                        <a href="javascript:;" class="close" data-bs-dismiss="alert">×</a>#}
            {#                        <h4 class="alert-heading">{{ noticia.titular }}</h4>#}
            {#                        {{ noticia.cuerpo|safe }}#}
            {#                    </div>#}
            {#                {% endfor %}#}
            {#                {% if reporte_0 and imprimirficha %}#}
            {#                    <div class="alert alert-info">#}
            {#                        <a href="javascript:;" class="close" data-bs-dismiss="alert">×</a>#}
            {#                        <h4 class="alert-heading">Ficha de preinscrito</h4>#}
            {#                        Para imprimir su ficha de preinscrito presione <a href="javascript:;" tipos="{{ reporte_0.tiporeporte }}" nhref="/reportes?action=run&n={{ reporte_0.nombre }}&inscripcion={{ inscripcion.id }}" class="reportedirecto">Aquí</a>#}
            {#                    </div>#}
            {#                {% endif %}#}
            {#            {% endif %}#}
        </div>
        {# CONTENIDO ADICIONAL #}

        {# MODULOS FAVORITOS #}
        {% if modulos_favoritos %}
            <div class='col-lg-12 pb-2' id="misFavoritosContenedor" style="margin-bottom: 12px;">
                <h4 class="mb-2" style="color: #012E46;">&nbsp;<b><i class="fa fa-bookmark"></i> Mis Favoritos</b></h4>
                <div class="containerMenuFavoritos">
                    <ul class="menuPanelFavoritos">
                        {% for modulo in modulos_favoritos %}
                            <li class='action-menu-entry modFavorito' data-id="{{ modulo.pk }}"
                                url='{{ modulo.url }}' style="{% if eTemplateBaseSetting and eTemplateBaseSetting.use_menu_favorite_module or eTemplateBaseSetting.use_menu_notification or eTemplateBaseSetting.use_menu_user_manual or not perfilprincipal.es_estudiante %}height: 200px;{% else %}height: 200px;{% endif %}">
                                <div class="iconfavorite">
                                    <div style="padding: 5px 15px 0px; width: 100%">
                                        {% if modulo.id in ids_modulos_favoritos %}
                                            <a href="javascript:;" class="action-menu-favorite tr" title="Quitar de favorito" value="1" idm="{{ modulo.id }}" text="{{ modulo.nombre }}" style="float:left"><i class="fa fa-star text-warning"></i></a>
                                        {% endif %}
                                    </div>
                                </div>
                                <div class='iconimage'>
                                    <div class='pd'>
                                        <img class="icofav{{ modulo.id }} iconosga" src='{{ modulo.icono }}' border="0"/>
                                    </div>
                                </div>
                                <div class='iconname'>
                                    <div class='pd'>
                                        <div class='tituloicon'>{{ modulo.nombre }}</div>
                                        <span class='icondesc'>{{ modulo.descripcion }}</span>
                                    </div>
                                </div>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        {% endif %}
        {# MODULOS FAVORITOS #}

        {% if CATEGORIZACION_MODULOS %}
            {# MODULOS #}
            <div class='{% if banerderecho or banerderecho_muestra or noticias %}col-lg-8{% else %}col-lg-12{% endif %}'>
                <h4 class="mb-2" style="color: #012E46;"><b>&nbsp;<i class="fas fa-layer-group"></i> Mis Módulos</b></h4>
{#                <p class="text-muted">Para una mejor experiencia, puedes buscar una opción dentro de las categorías</p>#}
                <div class="containerMenu" id="mybuscador">
                    <div class="accordion" id="accordionMenu">
                        {% for cat in CATEGORIAS_MODULOS %}
                            <div class="accordion-item-menu" style="margin-bottom: 8px">
                                <h2 class="accordion-header " id="categoria{{ cat.id }}">
                                    <button class="rounded-3 accordion-button {% if not forloop.first %}collapsed{% endif %} accordion-btn-white  fs-4 px-3" type="button" data-bs-toggle="collapse" data-bs-target="#categoriaMenu{{ cat.id }}" aria-expanded="false" aria-controls="categoriaMenu{{ cat.id }}">
                                        {#                                    <button class="accordion-button-menu collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#categoriaMenu{{ cat.id }}" aria-expanded="false" aria-controls="categoriaMenu{{ cat.id }}">#}
                                        <b style="color:#18113c"><i class="{{ cat.icono|safe }} fs-3 me-2" style="color:#18113c"></i> {{ cat.nombre|title }}</b>
                                    </button>
                                </h2>
                                <div style="background: #f5f4f8;" id="categoriaMenu{{ cat.id }}" class="accordion-collapse  {% if forloop.first %}show{% else %}collapse{% endif %} panelModulos" aria-labelledby="categoria{{ cat.id }}" data-bs-parent="#accordionMenu">
                                    {#                                <div style="background: #f5f4f8;" id="categoriaMenu{{ cat.id }}" class="accordion-collapse collapse panelModulos" aria-labelledby="categoria{{ cat.id }}" data-bs-parent="#accordionMenu">#}
                                    <div class="accordion-body" style="padding: 0.25rem 0.25rem !important;">
                                        <div class="containerMenuFavoritos">
                                            <ul class="menuPanelFavoritos">
                                                {% with listmodulos=cat|args:persona|args:ids_modulos_favoritos|call:"mismodulos" %}
                                                    {% for modulo in listmodulos %}
                                                          <li class='action-menu-entry modFavorito' data-id="{{ modulo.pk }}"
                                                            url='{{ modulo.url }}' style="{% if eTemplateBaseSetting and eTemplateBaseSetting.use_menu_favorite_module or eTemplateBaseSetting.use_menu_notification or eTemplateBaseSetting.use_menu_user_manual or not perfilprincipal.es_estudiante %}height: 200px;{% else %}height: 200px;{% endif %}">
                                                            <div class="iconfavorite">
                                                                <div style="padding: 5px 15px 0px; width: 100%">
                                                                    {% if modulo.id in ids_modulos_favoritos %}
                                                                        <a href="javascript:;" class="action-menu-favorite tr" title="Quitar de favorito" value="1" idm="{{ modulo.id }}" text="{{ modulo.nombre }}" style="float:left"><i class="fa fa-star text-warning"></i></a>
                                                                    {% else %}
                                                                        <a href="javascript:;" class="action-menu-favorite tr" title="Agregar a favoritos" value="0" idm="{{ modulo.id }}" text="{{ modulo.nombre }}" style="float:left"><i class="bi bi-star"></i></a>

                                                                    {% endif %}
                                                                </div>
                                                            </div>
                                                            <div class='iconimage'>
                                                                <div class='pd'>
                                                                    <img class="icofav{{ modulo.id }} iconosga" src='{{ modulo.icono }}' border="0"/>
                                                                </div>
                                                            </div>
                                                            <div class='iconname'>
                                                                <div class='pd'>
                                                                    <div class='tituloicon'>{{ modulo.nombre }}</div>
                                                                    <span class='icondesc'>{{ modulo.descripcion }}</span>
                                                                </div>
                                                            </div>
                                                        </li>
                                                    {% endfor %}
                                                {% endwith %}
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            {# MODULOS #}
        {% else %}
            {# MODULOS #}
            <div class='{% if banerderecho or banerderecho_muestra %}col-lg-8{% else %}col-lg-12{% endif %} menuPanelModulos'>
                <h4 class="mb-2" style="color: #012E46;"><b>&nbsp;<i class="fas fa-layer-group"></i> Mis Módulos</b></h4>
                {#                <p class="text-muted">Para una mejor experiencia, puedes buscar una opción dentro de las categorías</p>#}
                <div class="containerMenu" id="mybuscador">

                    <div class="menuPanelCard">
                        {% for modulo in mismodulos %}
                            <div data-nombre="{{ modulo.nombre|lower }}" url='{{ modulo.url }}' class='carbon-example flex-wrapper action-menu-entry'>
                                <div class="iconfavorite">
                                    <div style="padding: 4px 13px -2px; width: 100%">
                                        {% if modulo.id in ids_modulos_favoritos %}
                                            <a href="javascript:;" class="action-menu-favorite tr" title="Quitar de favorito" value="1" idm="{{ modulo.id }}" text="{{ modulo.nombre }}" style="float:left; margin-bottom: 50px; font-size:13px"><i class="fa fa-star text-warning"></i></a>
                                        {% else %}
                                            <a href="javascript:;" class="action-menu-favorite tr" title="Agregar a favorito" value="0" idm="{{ modulo.id }}" text="{{ modulo.nombre }}" style="float:left; margin-bottom: 50px; font-size:13px"><i class="bi bi-star"></i></a>
                                        {% endif %}
                                    </div>
                                </div>
                                <img src='{{ modulo.icono }}' border="0" class="avatar-md iconosga"/>
                                <div class="inner-wrapper">
                                    <h4 class="mb-1" style="font-size: 14px;">
                                        <div class='tituloicon' data-inicial="{{ modulo.nombre.0 }}">{{ modulo.nombre }}</div>
                                    </h4>
                                    <span class='icondesc'>{{ modulo.descripcion }}</span>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            {# MODULOS #}
        {% endif %}


            <div class="col-lg-4 hidden-tablet hidden-phone visible-desktop row" style="margin-top: 20px !important">
            {% if banerderecho_muestra %}
                <div id="carouselNoticiasMuestra" class="carousel slide lista_actividades" data-bs-ride="carousel">
                    <div class="carousel-inner" role="listbox" style="background-color: white; border-radius: 20px !important;">
                        {% for noticia in banerderecho_muestra %}
                            <div class="carousel-item {% if forloop.first %}active{% endif %}">
                                <div class="panel_logo">
                                    <h2 class="texto-blue" style="margin-left: 4px; font-weight: 600"> {{ noticia.noticia__titular }}</h2>
                                </div>
                                {% if noticia.noticia__imagen__archivo %}
                                    <img src="/media/{{ noticia.noticia__imagen__archivo }}" class="fancybox" id="noticiagrafica"
                                         width="100%">
                                {% endif %}
                                {{ noticia.noticia__cuerpo|safe }}
                            </div>
                        {% endfor %}
                    </div>
                    {% if banerderecho|length > 1 %}
                        <a class="carousel-control-prev" href="#carouselNoticiasMuestra" role="button" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true" style="color: black; border-radius: 18px; background-color: #d1d1d1; width: 30px; margin-left: -15px;"></span>
                        </a>
                        <a class="carousel-control-next" href="#carouselNoticiasMuestra" role="button" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true" style="color: black; border-radius: 18px; background-color: #d1d1d1; width: 30px; margin-right: -16px;"></span>
                        </a>
                    {% endif %}
                </div>
            {% endif %}
            {% if banerderecho %}
                <div id="carouselNoticias" class="carousel slide lista_actividades" data-bs-ride="carousel" style="height: 366px;">
                    <div class="carousel-inner" role="listbox" style="background-color: white; border-radius: 20px !important;">
                        {% for noticia in banerderecho %}
                            <div class="carousel-item {% if forloop.first %}active{% endif %}">
                                <div class="panel_logo">
                                    <h2 class="texto-blue" style="margin-left: 4px; font-weight: 600"> {{ noticia.titular }}</h2>
                                </div>
                                {% if noticia.imagen__archivo %}
                                    <img src="/media/{{ noticia.imagen__archivo }}" class="fancybox" id="noticiagrafica"
                                         width="100%">
                                {% endif %}
                                {{ noticia.cuerpo|safe }}
                            </div>
                        {% endfor %}
                    </div>
                    {% if banerderecho|length > 1 %}
                        <a class="carousel-control-prev" href="#carouselNoticias" role="button" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true" style="color: black; border-radius: 18px; background-color: #d1d1d1; width: 30px; margin-left: -15px;"></span>
                        </a>
                        <a class="carousel-control-next" href="#carouselNoticias" role="button" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true" style="color: black; border-radius: 18px; background-color: #d1d1d1; width: 30px; margin-right: -16px;"></span>
                        </a>
                    {% endif %}
                </div>
            {% endif %}
            </div>
        {# NOTICIAS #}

    </div>

{% endblock %}

{% block moreblock %}

    {% if utiliza_modulo_encuestas %}
        <div class="modal fade opacity" id="encuestapanel" style="display: none;" data-backdrop="static" data-keyboard="false" tabindex="-1" aria-hidden="true"></div>
    {% endif %}

{% endblock %}
